{"componentChunkName":"component---src-templates-blog-post-js","path":"/10-22-2019/","webpackCompilationHash":"","result":{"data":{"site":{"siteMetadata":{"title":"Web Dev Tutorials","author":"Shehan Atuk "}},"markdownRemark":{"id":"87815e72-bfbf-585b-a872-fe691a776809","excerpt":"Forms are a vital part of the web. They allow us to communicate with each other in a very easy and effective way. Today we will learn how to set up a user…","html":"<p>Forms are a vital part of the web. They allow us to communicate with each other in a very easy and effective way. Today we will learn how to set up a user registration form on a Ruby On Rails application. </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ab11d3c059a838f7da4b93351d518a66/8ff1e/img1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 57.125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABi0lEQVQoz52RW0sCQRiG968VhN31M4qMovuCbkS6KS2jMBXFtJNdWugaVlQXlUSkFVGQkLltBaLu6rq739vMRNH59MHDzMe88wwzIw24wxiZXKDZZRmzS5wUIy3wLz7NQyvrgmAigwDLCRIypudXMR1Psj4N10yC+l0BSG3dYzQaXkO9Xqfi9Q3Kt3colVXGLRT1HnW9+Q7jZa41DNGbpkXuUBLtPR6SHE4PppayeLhTkM1mkc8fI5fLYX9vD4V8Hr8tbyyNzj4vhNAbl9Fq6qhWqx+CRPQttk0iNz6XgsP5Smg0dCiKAk3TBLZtC/imZ/Fnh9n0iXAinkFDq6FQOIGqqmgaxpeSXwm9MRlWy0CxWESlUoGu6+yhzTdX/ouQPEzY0DU6v7jEdamEEqNaq4mwZdmw7C9ga6ZlCfdYNMU/haSOXg98CxlxzFX5Af+tibhM3CV1Dfpo2JfAdu6U5J0jbOwXsCk4wdbBz/Dc7uEZDTEHd0nh6LwZjMQwE4yQPxTl498JRIg7uOsRgwf6QCrw0X8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"registration form\"\n        title=\"registration form\"\n        src=\"/static/ab11d3c059a838f7da4b93351d518a66/b9e4f/img1.png\"\n        srcset=\"/static/ab11d3c059a838f7da4b93351d518a66/cf440/img1.png 148w,\n/static/ab11d3c059a838f7da4b93351d518a66/d2d38/img1.png 295w,\n/static/ab11d3c059a838f7da4b93351d518a66/b9e4f/img1.png 590w,\n/static/ab11d3c059a838f7da4b93351d518a66/8ff1e/img1.png 800w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p align=\"center\">Figure 1: A Basic Registration Form.</p>\n<h3>What You Will Need</h3>\n<p>Before starting make sure you have a scaffolded Rails application. I will use the Article scaffold for this post. Also we will need a User model and Users controller which we will go over on how to create. So let’s get started!</p>\n<h3>Setup</h3>\n<p>First let’s create our migration. We will need to create the user table using a migration by running: <code class=\"language-text\">rails generate migration AddUsersTable</code> then adding the following snippet to the migration file located at <code class=\"language-text\">db/migrate</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    create_table :users do |t|\n        t.string :username,    null: false, default: &quot;&quot;\n        t.string :email,       null: false, default: &quot;&quot;\n        t.string :password,    null: false, default: &quot;&quot;\n        t.string :fullName\n        t.text :bio\n        t.string :password_reset_token\n        t.datetime :password_reset_sent_at\n        t.timestamps\n    end </code></pre></div>\n<p>Let’s go over the migration: it creates a users table with the listed attributes in the database. To complete the migration run: <code class=\"language-text\">rails db:migrate RAILS_ENV=development</code> in the terminal. </p>\n<p>We will need one model: User. Run: <code class=\"language-text\">rails generate model User</code> to generate the User model then add the following code to the generated file:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># app/models/user.rb \nclass User &lt; ApplicationRecord\n    validates_presence_of :username, :fullName, :bio\n    validates_uniqueness_of :username \n    validates_uniqueness_of :email\n    validates :email, format: { with: URI::MailTo::EMAIL_REGEXP }, presence: true\n    validates :password, presence: true\n    validates :password, confirmation: { case_sensitive: true }\nend </code></pre></div>\n<p>The User model contains validations for the attributes of the user table. These will ensure that ActiveRecord will make sure the validations pass before entering new records into the database as this will prevent incorrect information from entering the database. </p>\n<p>Let us create the user controller by running: <code class=\"language-text\">rails generate controller UsersController</code>. Navigate to the <code class=\"language-text\">app/controllers/users_controller.rb</code> file and add the following code:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">class UsersController &lt; ApplicationController\n    def new \n        @user = User.new \n        render &quot;new&quot;\n    end \n\n    def create \n        user = User.new(params[:user])\n        if user.save!\n            flash[:notice] = &quot;User created successfully&quot;\n            redirect_to root_url\n        else \n            flash[:notice] = &quot;User registration failed&quot;\n            render &quot;new&quot;\n        end \n    end \nend</code></pre></div>\n<p>The new action renders the <code class=\"language-text\">new.html.erb</code>, the file containing the registration form. The create action processes the submission and handles redirection. If the creation of a new user fails the registration form is re-rendered with a flash notice, which is basically a message to be displayed on screen, notifying the user of the unexpected failure. The ! at the end of <code class=\"language-text\">user.save</code> is a verbose flag that logs errors to the terminal. This makes debugging easier through the increase in transparency behind the scenes. </p>\n<p>On to the views! Navigate to the <code class=\"language-text\">app/views/users</code> folder and create a file: <code class=\"language-text\">new.html.erb</code>. Add the following code to it:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">&lt;%= form_with(url: users_path, model: @user) do |form| %&gt;\n    &lt;% if @user.errors.any? %&gt;\n        &lt;div class=&quot;user_errors&quot;&gt;\n            &lt;% @user.errors.full_messages.each do |error| %&gt;\n                &lt;p&gt;&lt;%= error %&gt;&lt;/p&gt;\n            &lt;% end %&gt;\n        &lt;/div&gt;\n    &lt;% end %&gt;\n&lt;%= form.label :username, &quot;Username: &quot; %&gt;\n&lt;%= form.text_field :username %&gt;\n\n&lt;%= form.label :email, &quot;Email: &quot; %&gt;\n&lt;%= form.text_field :email %&gt;\n\n&lt;%= form.label :password, &quot;Password: &quot; %&gt;\n&lt;%= form.password_field :password %&gt;\n\n&lt;%= form.label :password_confirmation, &quot;Confirm Password: &quot; %&gt;\n&lt;%= form.password_field :password_confirmation %&gt;\n\n&lt;%= form.label :fullName, &quot;Full Name: &quot; %&gt;\n&lt;%= form.text_field :fullName %&gt;\n\n&lt;%= form.label :bio, &quot;Bio: &quot; %&gt;\n&lt;%= form.text_field :bio %&gt;\n\n&lt;%= form.submit &quot;Submit&quot; %&gt;\n\n&lt;% end %&gt;</code></pre></div>\n<p>This form is set up to send a user object as a submission parameter through the <code class=\"language-text\">model: @user</code> option in the <code class=\"language-text\">form_with</code> helper tag. Once the user clicks the submit button a user object containing all the necessary fields are sent to the create action. This was specified through <code class=\"language-text\">users_path</code>, which is a named route. The conditional if statement near the top is for rendering errors caught by ActiveRecord validations defined in the User model. For example: if the end-user submits with an empty email field ActiveRecord will insert an error message into the <code class=\"language-text\">@users.full_messages</code> array which is then rendered on screen through the for loop. </p>\n<p>If you are wondering how the two password fields are validated it is done through the <code class=\"language-text\">validates :password, confirmation: { case_sensitive: true }</code> line in the User model. This line takes the two password fields and ensures that they are equal through string comparison. Note: for this validation to work it is imperative that the two password fields be called <code class=\"language-text\">password</code> and <code class=\"language-text\">password_confirmation</code>, as anything other than this will throw an error. </p>\n<h3>Testing</h3>\n<p>Now with everything setup up we have to define some routes in the <code class=\"language-text\">config/routes</code> file. Add the following to it:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Rails.application.routes.draw do\n    root &#39;articles#index&#39;\n    resources :users\nend</code></pre></div>\n<p>The <code class=\"language-text\">root</code> keyword sets the application homepage to be rendered by the index action of Articles controller and the <code class=\"language-text\">resources</code> keyword creates the CRUD operation routes for the Users controller. </p>\n<p>Start up the server through the command: <code class=\"language-text\">rails server</code> and navigate to the path <code class=\"language-text\">/users/new</code>. You should see a registration form. Try submitting it with empty fields to verify that the errors are rendered on screen. Then try a success use case and the browser should redirect to the root url.</p>\n<h3>Closing Notes</h3>\n<p>If everything went well, congrats! You have set up your own registration form. But currently it is storing the password as a plain text string. This is very dangerous as the password is publicly exposed to anyone with access to the database file. To prevent this we must use password hashing, a method of encryption. Accordingly, that will be what the next post will be on so stay tuned!</p>\n<p>Well that’s all for today, I hope you found this review helpful. I would greatly appreciate if you could check out my <a href=\"https://www.youtube.com/channel/UCtxed_NljgtAXrQMMdLvhrQ?\">Youtube channel</a>, follow me on <a href=\"https://twitter.com/Shehan_Atuk\">Twitter</a>, <a href=\"https://www.linkedin.com/in/shehan-a-780622126/\">LinkedIn</a>, <a href=\"https://github.com/ShehanAT\">Github</a> and <a href=\"https://www.instagram.com/shehanthewebdev/\">Instagram</a>.</p>","frontmatter":{"title":"Form Submission in Ruby On Rails","date":"October 22, 2019","description":"How to setup and submit a registration form in Ruby On Rails"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/10-22-2019/","previous":{"fields":{"slug":"/10-18-2019/"},"frontmatter":{"title":"Password Reset Form In Ruby On Rails"}},"next":null}}}
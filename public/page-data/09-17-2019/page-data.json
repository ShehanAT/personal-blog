{"componentChunkName":"component---src-templates-blog-post-js","path":"/09-17-2019/","result":{"data":{"site":{"siteMetadata":{"title":"Web Dev Tutorials","author":"Shehan Atuk "}},"markdownRemark":{"id":"89a1e58d-efe9-5124-a0d0-689d1c4ec2e3","excerpt":"Hello everyone, In this second part of the Unit Testing of Models in Ruby On Rails I will go more in depth on how to unit test models using model validations…","html":"<p>Hello everyone,</p>\n<p>In this second part of the Unit Testing of Models in Ruby On Rails I will go more in depth on how to unit test models using model validations.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e65e48c37f37b67f09549c9b8867f353/83e77/img1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 35.810810810810814%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAB8UlEQVQozw2PW08TYQBE98eYmGCIBIqImCAoDQpIbWm7bell99tt2d22dEsL1kvgwURNREEuClIxbUkwKtJLGhOBaILxxRdN/89xH04mMw+TGelPs8HfRoNOq0mn2aLzrU3ntM2/tuO/1vl91OL8Y51fhw1+HDU4r7f5+aXF2ecWJ5+anFTqnO4cc7J7zHcHaStfYNPIsJk02YuYbJs5tp3srZFjXzZ55zfZvWfw5u4cz8cFi0My2f4Z8oMR8lfCFHojlHoTDoJij4b0vrjEjp2nbOWoiRzVeJaatkAttURVXaQaK/DsjiAzIOO/OI162UPa5SM7EKQ0EmPFLVh2eHhT8GA0hbSvpymnLMq64WiaPSNLWZjs6xk+xPNsBbPYQzMo/T68XZOURkO88KrMX/NyfzhC4UYcpceHcAVQ+vxIm5rgVUpjS6TYmLNYtSzWooJVRWMjmeVpxGDZM4vqDhAd9rKeTrNr2yxMRIm5ZLTrCeKDMTzdAcYueJAqhqCqx5y7s1SSMSqK7CwLcaCqVAzLKdR4qc6h3ZIRYzO8toqsx21Kbp3E1VmKExkWJ9KYIzpTlwJIB1GFajBCNRCm5gtzEE5yqNisTessDwdZGU/weMog0O1Ddq498eZ4NGViO4WhvjDzboP8bYuEs3Kyy89/U89Hg4zxig4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Unit tests diagram\"\n        title=\"Unit tests diagram\"\n        src=\"/static/e65e48c37f37b67f09549c9b8867f353/fcda8/img1.png\"\n        srcset=\"/static/e65e48c37f37b67f09549c9b8867f353/12f09/img1.png 148w,\n/static/e65e48c37f37b67f09549c9b8867f353/e4a3f/img1.png 295w,\n/static/e65e48c37f37b67f09549c9b8867f353/fcda8/img1.png 590w,\n/static/e65e48c37f37b67f09549c9b8867f353/efc66/img1.png 885w,\n/static/e65e48c37f37b67f09549c9b8867f353/83e77/img1.png 889w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p align=\"center\">Figure 1: Unit testing in action.</p>\n<h3>Model Validation Unit Testing</h3>\n<p>Continuing with the Article model from part 1, let’s assume it has two attributes: title and body. Now, we want to invoke an ActiveRecord error whenever we try to save an instance of Article without title and body attributes. </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">test &quot;should not save article with empty title and body&quot; do \n    article = Article.new \n    assert_not article.save, &quot;article is saving without title and/or body fields&quot;\nend </code></pre></div>\n<p>This test will pass if the calling of <code class=\"language-text\">article.save</code> returns an error, but let’s go over the syntax of this test. The statement enclosed in double quotes between <code class=\"language-text\">test ... do</code> is the name of this test, which will be use to differentiate between test when more test are added. The line <code class=\"language-text\">article = Article.new</code> is creating an instance of Article and assigning it to the variable <code class=\"language-text\">article</code>. Note: the <code class=\"language-text\">new</code> mass assignment operator does not automatically save the object created with it, unlike the <code class=\"language-text\">create</code> operator which creates then saves the object if validations pass. Then the line <code class=\"language-text\">assert_not article.save ...</code> is checking for an error thrown by ActiveRecord, which is the model in the MCV framework we call Ruby On Rails, upon trying to save the object to the database. </p>\n<p>. So let’s run this test and check if it passes. </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ArticleTest#should_not_save_article_with_empty_title_and_body\narticle is saving without title and/or body fields\n runs, 3 assertions, 1 failures, 0 errors, 0 skips</code></pre></div>\n<p> Nope! The problem is that <code class=\"language-text\">article</code> is being saved when it shouldn’t be. To fix this let’s add two validations, one for title and other for body, in the <code class=\"language-text\">Article</code> model file. </p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">class ArticleModel &lt; ApplicationRecord \n    validates :title, presence: true    \n    validates :body, presence: true\nend </code></pre></div>\n<p>Notice the <code class=\"language-text\">presence</code> option set to true which does the work of making sure the corresponding fields exist before saving the object to the database. </p>\n<p>Now let’s run the test…</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Finished in 0.208449s, 14.3920 runs/s, 14.3920 assertions/s.\n3 runs, 3 assertions, 0 failures, 0 errors, 0 skips</code></pre></div>\n<p>And the test passes! Now we can be sure that validations are working whenever we run <code class=\"language-text\">rails test RAILS_ENV=test</code> through the passing of the <code class=\"language-text\">ArticleTest#should_not_save_article_with_empty_title_and_body</code> unit test. </p>\n<p>That concludes the unit testing of models in Ruby On Rails. Did we cover everything regarding model testing in Rails? No, but we covered the basics and that is sufficient for now. In the future I will write more about this topic so stay tuned!</p>\n<p>Well that’s all for today, I hope you found this review helpful. I would greatly appreciate if you could check out my <a href=\"https://www.youtube.com/channel/UCtxed_NljgtAXrQMMdLvhrQ?\">Youtube channel</a>, follow me on <a href=\"https://twitter.com/Shehan_Atuk\">Twitter</a>, <a href=\"https://www.linkedin.com/in/shehan-a-780622126/\">LinkedIn</a>, <a href=\"https://github.com/ShehanAT\">Github</a> and <a href=\"https://www.instagram.com/shehanthewebdev/\">Instagram</a>.</p>","frontmatter":{"title":"Basic Unit Testing of Models in Ruby On Rails App Part 2","date":"September 17, 2019","description":"Continuation of Unit Testing Models in Ruby On Rails Part 1"}}},"pageContext":{"slug":"/09-17-2019/","previous":{"fields":{"slug":"/09-13-2019/"},"frontmatter":{"title":"Basic Unit Testing of Models in Ruby On Rails App Part 1"}},"next":{"fields":{"slug":"/09-20-2019/"},"frontmatter":{"title":"Basic Integration Testing For Ruby On Rails Apps Part 1"}}}},"staticQueryHashes":["426816048","63159454"]}